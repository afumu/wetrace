# 词云分析

词云分析功能对聊天记录中的文本消息进行词频统计，以可视化词云和词频排行的形式展示高频词汇，帮助你快速发现聊天中的关键话题。

## 进入词云分析

在左侧导航栏点击「词云分析」即可进入。页面默认以全局模式加载词云数据。

## 分析模式

页面顶部提供两种分析模式切换：

- **全局词云**：分析所有会话中的文本消息，展示整体聊天的高频词汇
- **指定会话**：选择某个联系人或群聊，仅分析该会话内的文本消息

切换模式后，词云数据会自动重新加载。

## 筛选条件

### 选择会话（仅指定会话模式）

在「指定会话」模式下，需要先选择目标会话：

1. 在搜索框中输入联系人昵称或 ID
2. 从下拉列表中点击选择目标会话
3. 选中后搜索框下方会显示「已选择: xxx」的确认提示

### 日期范围

通过「开始日期」和「结束日期」两个日期选择器限定分析的时间范围。留空则默认分析全部历史消息。日期格式为 `YYYY-MM-DD`，系统会自动将其组合为 `开始日期~结束日期` 的格式传递给后端。

### 词汇数量

通过数字输入框设置词云中展示的最大词汇数量：

- 最小值：10
- 最大值：500
- 默认值：100

数值越大，词云中展示的词汇越多，但过多的词汇可能影响可视化效果。建议根据实际需要调整。

## 统计卡片

筛选条件下方展示 3 张统计卡片：

| 卡片 | 说明 |
|------|------|
| 分析消息数 | 参与本次词频分析的文本消息总条数 |
| 总词汇数 | 分词后去除停用词的有效词汇总数 |
| 高频词数 | 最终展示在词云中的词汇数量（受词汇数量限制） |

## 词云可视化

统计卡片下方展示词云图。词云的展示规则如下：

- 词频越高的词汇，字号越大（最大 48px，最小 12px）
- 每个词汇使用不同的颜色，共 15 种配色循环使用
- 词频越高的词汇透明度越高，视觉上更突出
- 鼠标悬停在某个词汇上，会显示该词的文本和出现次数（如「开心: 128 次」）

系统采用中文二元组（bigram）分词方式提取中文词汇，同时支持英文单词提取，并自动过滤常见停用词（如「的」「了」「是」等）。

## 词频排行 TOP 30

词云图下方展示词频排行榜，以条形进度条的形式列出前 30 个高频词汇。每一行包含：

- 排名序号（1-30）
- 词汇文本
- 彩色进度条（长度按词频占比缩放，颜色循环使用）
- 出现次数

排行按出现次数从高到低排列，直观展示哪些词汇在聊天中出现最频繁。
